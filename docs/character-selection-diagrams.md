# Character Selection - Architecture Diagrams and Visual Documentation

> **Visual Reference**: Diagrams, mockups, and visual representations of the Character Selection architecture.

## Table of Contents
1. [System Architecture](#system-architecture)
2. [Component Hierarchy](#component-hierarchy)
3. [Data Flow Diagrams](#data-flow-diagrams)
4. [UI Layout Mockups](#ui-layout-mockups)
5. [Character Selector UI Options](#character-selector-ui-options)
6. [State Management](#state-management)
7. [Sequence Diagrams](#sequence-diagrams)
8. [File Structure](#file-structure)

---

## System Architecture

### High-Level System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Chattr Application                       â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              React Context Layer                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ LanguageContext  â”‚  â”‚   ModeContext       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - targetLang    â”‚  â”‚   - mode            â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                              â†“                      â”‚    â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚  â”‚                    â”‚ CharacterContext    â”‚ (NEW)   â”‚    â”‚
â”‚  â”‚                    â”‚  - selectedCharacterâ”‚         â”‚    â”‚
â”‚  â”‚                    â”‚  - 5 preset chars   â”‚         â”‚    â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚  â”‚              â†“              â†“             â†“         â”‚    â”‚
â”‚  â”‚      localStorage    localStorage   localStorage   â”‚    â”‚
â”‚  â”‚   'chattr_target'  'chattr_mode' 'chattr_selected' â”‚    â”‚
â”‚  â”‚      '_language'                    '_character'    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â†“                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              UI Component Layer                     â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚  Language   â”‚  â”‚    Mode      â”‚  â”‚Character â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  Selector   â”‚  â”‚  Selector    â”‚  â”‚ Selector â”‚ â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚              â”‚  â”‚  (NEW)   â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚         MessageList                      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  (Bilingual messages in conv mode)      â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚         ChatInput (Enhanced)             â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  - Passes characterId to API            â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â†“                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              API Layer (Next.js)                    â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ /api/        â”‚  â”‚ /api/conversation       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  translate   â”‚  â”‚ (Enhanced with          â”‚    â”‚    â”‚
â”‚  â”‚  â”‚              â”‚  â”‚  character support)     â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                 â†“                      â†“                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“                      â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   DeepL API         â”‚  â”‚   OpenAI API          â”‚
    â”‚   - Translation     â”‚  â”‚   - GPT-3.5-turbo     â”‚
    â”‚                     â”‚  â”‚   - Character prompts â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy

### Complete Component Tree

```
App (_app.tsx)
â”‚
â”œâ”€ LanguageProvider (existing)
â”‚  â”‚
â”‚  â””â”€ ModeProvider (existing)
â”‚     â”‚
â”‚     â””â”€ CharacterProvider (NEW)
â”‚        â”‚
â”‚        â””â”€ Component (pages/index.tsx)
â”‚           â”‚
â”‚           â”œâ”€ Head (meta tags)
â”‚           â”‚
â”‚           â””â”€ main
â”‚              â”‚
â”‚              â”œâ”€ Header Section
â”‚              â”‚  â”œâ”€ LanguageSelector (existing)
â”‚              â”‚  â”œâ”€ ModeSelector (existing)
â”‚              â”‚  â””â”€ CharacterSelector (NEW, conditional)
â”‚              â”‚     â””â”€ Shows only when mode = 'conversation'
â”‚              â”‚
â”‚              â”œâ”€ MessageList (existing)
â”‚              â”‚  â””â”€ MessageBox[] (existing, bilingual in conv mode)
â”‚              â”‚
â”‚              â””â”€ ChatInput (existing, enhanced)
â”‚                 â””â”€ Passes characterId to API
```

### New Component: CharacterSelector

```
CharacterSelector (NEW)
â”‚
â”œâ”€ Props
â”‚  â”œâ”€ value?: string (optional, from context)
â”‚  â”œâ”€ onChange?: (characterId: string) => void
â”‚  â”œâ”€ classNames?: string
â”‚  â””â”€ disabled?: boolean
â”‚
â”œâ”€ State (from useCharacter)
â”‚  â”œâ”€ selectedCharacter: Character
â”‚  â”œâ”€ setSelectedCharacter: (c: Character) => void
â”‚  â””â”€ availableCharacters: Character[] (5 presets)
â”‚
â”œâ”€ Conditional Rendering
â”‚  â””â”€ Only renders when mode === 'conversation'
â”‚
â””â”€ Render
   â””â”€ Select Dropdown
      â”œâ”€ Label: "Character:"
      â””â”€ Options: 5 preset characters
         â”œâ”€ ğŸ‘¨â€ğŸ« Friendly Tutor
         â”œâ”€ ğŸ˜Š Casual Friend
         â”œâ”€ ğŸ’¼ Business Professional
         â”œâ”€ ğŸŒ Enthusiastic Travel Guide
         â””â”€ ğŸ§™ Wise Mentor
```

### Character Type Structure

```
Character
â”‚
â”œâ”€ id: string
â”‚  â””â”€ Unique identifier (e.g., 'friendly-tutor')
â”‚
â”œâ”€ name: string
â”‚  â””â”€ Display name (e.g., 'Friendly Tutor')
â”‚
â”œâ”€ description: string
â”‚  â””â”€ Short description for users
â”‚
â”œâ”€ systemPrompt: string
â”‚  â””â”€ AI personality prompt for OpenAI
â”‚
â”œâ”€ icon?: string
â”‚  â””â”€ Emoji or icon (e.g., 'ğŸ‘¨â€ğŸ«')
â”‚
â”œâ”€ tags?: string[]
â”‚  â””â”€ Categories (e.g., ['learning', 'formal'])
â”‚
â””â”€ isCustom?: boolean
   â””â”€ Stretch goal: distinguish custom characters
```

---

## Data Flow Diagrams

### Character Selection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User        â”‚
â”‚ Opens character â”‚
â”‚    dropdown     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CharacterSelector      â”‚
â”‚  Displays 5 options     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User selects        â”‚
â”‚ "Business Professional" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CharacterContext       â”‚
â”‚  Updates selectedChar   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    localStorage         â”‚
â”‚  Saves character ID     â”‚
â”‚ 'chattr_selected_       â”‚
â”‚      character'         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next conversation      â”‚
â”‚  uses selected char's   â”‚
â”‚    system prompt        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Conversation with Character Flow

```
User types message
      â†“
ChatInput captures input
      â†“
Checks mode = 'conversation'
      â†“
Reads selectedCharacter from context
      â†“
POST /api/conversation
  {
    userMessage,
    targetLanguage,
    conversationHistory,
    characterId: 'business-professional'  â† NEW
  }
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /api/conversation                 â”‚
â”‚                                    â”‚
â”‚  1. Look up character by ID        â”‚
â”‚     â””â”€ Find in PRESET_CHARACTERS   â”‚
â”‚                                    â”‚
â”‚  2. Get character.systemPrompt     â”‚
â”‚     â””â”€ "You are a professional     â”‚
â”‚        business colleague..."      â”‚
â”‚                                    â”‚
â”‚  3. Replace {targetLanguage}       â”‚
â”‚     â””â”€ "...learning Spanish..."    â”‚
â”‚                                    â”‚
â”‚  4. OpenAI completion              â”‚
â”‚     messages: [                    â”‚
â”‚       {role: 'system',             â”‚
â”‚        content: characterPrompt},  â”‚
â”‚       ...history,                  â”‚
â”‚       {role: 'user', content: msg} â”‚
â”‚     ]                              â”‚
â”‚                                    â”‚
â”‚  5. AI generates response          â”‚
â”‚     â””â”€ Personality reflects        â”‚
â”‚        character prompt            â”‚
â”‚                                    â”‚
â”‚  6. DeepL batch translate          â”‚
â”‚     â””â”€ User msg + AI response      â”‚
â”‚                                    â”‚
â”‚  7. Return bilingual response      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“
Display messages with character personality
```

### Character Switching Flow

```
User switches character mid-conversation
      â†“
CharacterSelector onChange fires
      â†“
CharacterContext updates
      â†“
localStorage saves new character
      â†“
Previous messages unchanged (history maintained)
      â†“
Next user message uses new character prompt
      â†“
AI response reflects new character personality
```

---

## UI Layout Mockups

### Current Layout (Before Character Selection)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Language: Spanish â–¼                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  [Translation | Conversation]         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚  MessageList                          â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Type here...           â”‚  Submit    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### New Layout with Character Selector (Desktop)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Language: Spanishâ–¼ â”‚ [Translation | Conversation] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Character: ğŸ‘¨â€ğŸ« Friendly Tutor â–¼                    â”‚ â”‚
â”‚  â”‚ â†‘ Only visible in Conversation mode               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Hello, how can I help you?                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ Hola, Â¿cÃ³mo puedo ayudarte?                 â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                   â”‚ â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚      â”‚ Thank you! I'm doing well. Â¿Y tÃº?      â”‚ â”‚ â”‚
â”‚  â”‚      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚
â”‚  â”‚      â”‚ Â¡Gracias! Estoy bien. And you?         â”‚ â”‚ â”‚
â”‚  â”‚      â”‚ (Friendly Tutor personality)            â”‚ â”‚ â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                   â”‚ â”‚
â”‚  â”‚  MessageList (Bilingual Messages)                â”‚ â”‚
â”‚  â”‚                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Type here...                     â”‚    Submit    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile Layout (Responsive < 768px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Language: Spanish â–¼  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚[Translation | Conv.] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â† Only in conversation mode
â”‚ â”‚ Character:           â”‚ â”‚
â”‚ â”‚ ğŸ‘¨â€ğŸ« Friendly Tutor â–¼ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                      â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Hello!           â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Â¡Hola!           â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚                      â”‚ â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚   â”‚ Good to chat!â”‚   â”‚ â”‚
â”‚ â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚ â”‚
â”‚ â”‚   â”‚ Â¡QuÃ© bueno!  â”‚   â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                      â”‚ â”‚
â”‚ â”‚ MessageList          â”‚ â”‚
â”‚ â”‚                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Type here...         â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚      Submit          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Character Selector UI Options

### Option A: Dropdown List (MVP - Recommended)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Character: ğŸ‘¨â€ğŸ« Friendly Tutor â–¼   â”‚ â† Closed state
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Character: ğŸ‘¨â€ğŸ« Friendly Tutor â–¼   â”‚ â† Open state
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘¨â€ğŸ« Friendly Tutor              âœ“ â”‚
â”‚ ğŸ˜Š Casual Friend                   â”‚
â”‚ ğŸ’¼ Business Professional           â”‚
â”‚ ğŸŒ Enthusiastic Travel Guide       â”‚
â”‚ ğŸ§™ Wise Mentor                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pros**: 
- Simple, familiar pattern
- Minimal development effort
- Mobile-friendly
- Good for 5 options

**Cons**:
- Limited space for descriptions
- Less visual appeal
- Harder to showcase personalities

### Option B: Modal with Grid (Phase 2 Enhancement)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Character: ğŸ‘¨â€ğŸ« Friendly Tutor [â–¼] â”‚ â† Button to open modal
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Click opens modal:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Select Your Character               [X]       â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    ğŸ‘¨â€ğŸ«    â”‚  â”‚    ğŸ˜Š    â”‚  â”‚    ğŸ’¼    â”‚    â”‚
â”‚  â”‚ Friendly  â”‚  â”‚  Casual  â”‚  â”‚ Business â”‚    â”‚
â”‚  â”‚  Tutor    â”‚  â”‚  Friend  â”‚  â”‚   Prof.  â”‚    â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚    â”‚
â”‚  â”‚ Patient   â”‚  â”‚ Informal â”‚  â”‚ Formal   â”‚    â”‚
â”‚  â”‚ and en-   â”‚  â”‚ and warm â”‚  â”‚ and pro- â”‚    â”‚
â”‚  â”‚ couraging â”‚  â”‚          â”‚  â”‚ fessionalâ”‚    â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚    â”‚
â”‚  â”‚ [Select] â”‚  â”‚ [Select] â”‚  â”‚ [Select] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚    ğŸŒ    â”‚  â”‚    ğŸ§™    â”‚                   â”‚
â”‚  â”‚ Travel   â”‚  â”‚   Wise   â”‚                   â”‚
â”‚  â”‚  Guide   â”‚  â”‚  Mentor  â”‚                   â”‚
â”‚  â”‚          â”‚  â”‚          â”‚                   â”‚
â”‚  â”‚ Energeticâ”‚  â”‚ Thought- â”‚                   â”‚
â”‚  â”‚ and des- â”‚  â”‚ ful and  â”‚                   â”‚
â”‚  â”‚ criptive â”‚  â”‚ reflec-  â”‚                   â”‚
â”‚  â”‚          â”‚  â”‚ tive     â”‚                   â”‚
â”‚  â”‚ [Select] â”‚  â”‚ [Select] â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pros**:
- Better character showcase
- More space for descriptions
- Visual appeal
- Easy to add more characters

**Cons**:
- More development effort
- Requires modal component
- May be overkill for 5 options

### Option C: Inline Cards (Alternative)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Select Character:                               â”‚
â”‚                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”            â”‚
â”‚ â”‚ ğŸ‘¨â€ğŸ« â”‚ â”‚ ğŸ˜Š â”‚ â”‚ ğŸ’¼ â”‚ â”‚ ğŸŒ â”‚ â”‚ ğŸ§™ â”‚            â”‚
â”‚ â”‚Tutorâ”‚â”‚Friendâ”‚â”‚Profâ”‚â”‚Guideâ”‚â”‚Mentorâ”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜            â”‚
â”‚   â–²                                              â”‚
â”‚   â””â”€ Selected                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pros**:
- Always visible
- Quick switching
- Visual icons prominent

**Cons**:
- Takes more vertical space
- Less room for descriptions
- Mobile layout challenge

**Decision**: Option A (Dropdown) for MVP, Option B (Modal) for Phase 2

---

## State Management

### CharacterContext State Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CharacterContext State             â”‚
â”‚                                             â”‚
â”‚  Initial State (on mount):                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ selectedCharacter =                â”‚    â”‚
â”‚  â”‚   PRESET_CHARACTERS[0]             â”‚    â”‚
â”‚  â”‚   (Friendly Tutor)                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â†“                              â”‚
â”‚  Check localStorage:                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ const saved = localStorage         â”‚    â”‚
â”‚  â”‚   .getItem('chattr_selected_       â”‚    â”‚
â”‚  â”‚            character')             â”‚    â”‚
â”‚  â”‚ if (saved && found)                â”‚    â”‚
â”‚  â”‚   selectedCharacter = found        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â†“                              â”‚
â”‚  Render with current character              â”‚
â”‚                                             â”‚
â”‚  On character change:                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. setSelectedCharacter(newChar)   â”‚    â”‚
â”‚  â”‚ 2. localStorage.setItem(charId)    â”‚    â”‚
â”‚  â”‚ 3. Re-render all consumers         â”‚    â”‚
â”‚  â”‚ 4. Next msg uses new character     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Character Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Default: Friendly Tutor
         â†•
    User Selection
         â†•
   localStorage Save
         â†•
   Context Update
         â†•
   Next Message Uses
   Character Prompt
```

### Context Provider Hierarchy

```
App
â”‚
â”œâ”€ LanguageProvider
â”‚  â””â”€ value: { targetLanguage, setTargetLanguage }
â”‚     â†“
â”‚     Consumed by: LanguageSelector, ChatInput, API
â”‚
â”œâ”€ ModeProvider
â”‚  â””â”€ value: { mode, setMode }
â”‚     â†“
â”‚     Consumed by: ModeSelector, ChatInput, CharacterSelector
â”‚
â””â”€ CharacterProvider (NEW)
   â””â”€ value: { 
        selectedCharacter, 
        setSelectedCharacter,
        availableCharacters 
      }
      â†“
      Consumed by: CharacterSelector, ChatInput, API
```

### Props Flow with Character

```
                    App
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚
 LanguageProvider ModeProvider CharacterProvider
        â”‚            â”‚            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
              Page Component
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚            â”‚
  LanguageSelector ModeSelector CharacterSelector ChatInput
        â”‚            â”‚            â”‚            â”‚
    useLanguage()  useMode()   useCharacter() â”‚
                                               â”‚
                                    Uses all 3 contexts:
                                    - targetLanguage
                                    - mode
                                    - selectedCharacter.id
```

---

## Sequence Diagrams

### User Selects Character

```
User       CharacterSelector   CharacterContext   localStorage   API
â”‚                â”‚                    â”‚                â”‚         â”‚
â”œâ”€ Click â”€â”€â”€â”€â”€â”€â”€â”€â†’                   â”‚                â”‚         â”‚
â”‚  dropdown      â”‚                    â”‚                â”‚         â”‚
â”‚                â”‚                    â”‚                â”‚         â”‚
â”œâ”€ Select â”€â”€â”€â”€â”€â”€â”€â†’                   â”‚                â”‚         â”‚
â”‚  "Business Pro"â”‚                    â”‚                â”‚         â”‚
â”‚                â”‚                    â”‚                â”‚         â”‚
â”‚                â”œâ”€ setCharacter() â”€â”€â”€â†’               â”‚         â”‚
â”‚                â”‚                    â”‚                â”‚         â”‚
â”‚                â”‚                    â”œâ”€ save() â”€â”€â”€â”€â”€â”€â”€â†’         â”‚
â”‚                â”‚                    â”‚                â”‚         â”‚
â”‚                â†â”€â”€â”€ re-render â”€â”€â”€â”€â”€â”€â”¤                â”‚         â”‚
â”‚                â”‚   (show "Bus Pro")  â”‚                â”‚         â”‚
â”‚                â”‚                    â”‚                â”‚         â”‚
```

### Conversation with Character

```
User    ChatInput   CharacterContext   /api/conversation   OpenAI   DeepL
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”œâ”€ Type â”€â”€â”€â†’             â”‚                   â”‚              â”‚        â”‚
â”‚  message â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”œâ”€ Submit â”€â†’             â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”œâ”€ useCharacter() â”€â†’              â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â†â”€â”€â”€ {id: 'casual-friend'} â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”œâ”€ POST request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚              â”‚        â”‚
â”‚          â”‚   {userMessage, targetLang,     â”‚              â”‚        â”‚
â”‚          â”‚    characterId: 'casual-friend'}â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”œâ”€ lookup char â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚  get prompt  â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”œâ”€ completion â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
â”‚          â”‚              â”‚                   â”‚   with char  â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚   prompt     â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â†â”€ AI response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚              â”‚                   â”‚  (casual tone)        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”œâ”€ translate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â†â”€ translations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚          â†â”€ Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚        â”‚
â”‚          â”‚   {userTranslation,              â”‚              â”‚        â”‚
â”‚          â”‚    aiResponse, aiTranslation}    â”‚              â”‚        â”‚
â”‚          â”‚              â”‚                   â”‚              â”‚        â”‚
â”œâ”€ See â”€â”€â”€â”€â”¤              â”‚                   â”‚              â”‚        â”‚
â”‚  messagesâ”‚              â”‚                   â”‚              â”‚        â”‚
â”‚  with    â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚  casual  â”‚              â”‚                   â”‚              â”‚        â”‚
â”‚  tone    â”‚              â”‚                   â”‚              â”‚        â”‚
```

### Character Switch During Conversation

```
User       CharacterSelector   Context    History    Next Message
â”‚                â”‚                â”‚          â”‚             â”‚
â”œâ”€ Conversation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’            â”‚
â”‚  in progress  â”‚                â”‚  Messages â”‚             â”‚
â”‚  (with Tutor) â”‚                â”‚  saved    â”‚             â”‚
â”‚                â”‚                â”‚          â”‚             â”‚
â”œâ”€ Switch to â”€â”€â”€â”€â†’               â”‚          â”‚             â”‚
â”‚  Casual Friend â”‚                â”‚          â”‚             â”‚
â”‚                â”‚                â”‚          â”‚             â”‚
â”‚                â”œâ”€ Update â”€â”€â”€â”€â”€â”€â”€â†’          â”‚             â”‚
â”‚                â”‚   context      â”‚          â”‚             â”‚
â”‚                â”‚                â”‚          â”‚             â”‚
â”œâ”€ Next message â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
â”‚  (new input)  â”‚                â”‚  History â”‚  Uses new   â”‚
â”‚                â”‚                â”‚  intact  â”‚  character  â”‚
â”‚                â”‚                â”‚          â”‚  prompt     â”‚
â”‚                â”‚                â”‚          â”‚             â”‚
â”œâ”€ Response â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  with casual  â”‚                â”‚          â”‚  (Casual    â”‚
â”‚  personality  â”‚                â”‚          â”‚   Friend)   â”‚
```

---

## File Structure

### Complete File Tree (With New Files Highlighted)

```
chattr/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”œâ”€â”€ ChatInput/
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx         â† MODIFIED (pass characterId)
â”‚   â”‚   â”‚   â””â”€â”€ ChatInput.module.scss
â”‚   â”‚   â”œâ”€â”€ Input/
â”‚   â”‚   â”œâ”€â”€ LanguageSelector/
â”‚   â”‚   â”œâ”€â”€ MessageBox/
â”‚   â”‚   â”œâ”€â”€ MessageList/
â”‚   â”‚   â”œâ”€â”€ ModeSelector/
â”‚   â”‚   â”œâ”€â”€ CharacterSelector/        â† NEW DIRECTORY
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterSelector.tsx      â† NEW
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterSelector.module.scss â† NEW
â”‚   â”‚   â”‚   â”œâ”€â”€ CharacterCard.tsx      â† NEW (Phase 2)
â”‚   â”‚   â”‚   â”œâ”€â”€ CustomCharacterModal.tsx â† NEW (Stretch)
â”‚   â”‚   â”‚   â””â”€â”€ index.ts               â† NEW
â”‚   â”‚   â””â”€â”€ index.ts                  â† MODIFIED (export CharacterSelector)
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â”œâ”€â”€ LanguageContext.tsx
â”‚   â”‚   â”œâ”€â”€ ModeContext.tsx
â”‚   â”‚   â””â”€â”€ CharacterContext.tsx      â† NEW
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useLanguage.ts
â”‚   â”‚   â”œâ”€â”€ useMode.ts
â”‚   â”‚   â””â”€â”€ useCharacter.ts           â† NEW
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ openai.ts                 â† MODIFIED (character prompts)
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ conversation.ts       â† MODIFIED (accept characterId)
â”‚   â”‚   â”‚   â””â”€â”€ translate.ts
â”‚   â”‚   â”œâ”€â”€ _app.tsx                  â† MODIFIED (add CharacterProvider)
â”‚   â”‚   â””â”€â”€ index.tsx                 â† MODIFIED (add CharacterSelector)
â”‚   â”‚
â”‚   â”œâ”€â”€ styles/
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ characters.ts             â† NEW (character definitions)
â”‚   â”‚   â”œâ”€â”€ events.ts
â”‚   â”‚   â””â”€â”€ languages.ts
â”‚   â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ character-selection-plan.md          â† NEW
â”‚   â”œâ”€â”€ character-selection-summary.md       â† NEW
â”‚   â”œâ”€â”€ character-selection-quick-reference.md â† NEW
â”‚   â”œâ”€â”€ character-selection-diagrams.md      â† NEW (this file)
â”‚   â”œâ”€â”€ conversation-mode-*.md
â”‚   â”œâ”€â”€ language-selector-*.md
â”‚   â””â”€â”€ README.md                            â† MODIFIED
â”‚
â”œâ”€â”€ README.md                                â† MODIFIED
â””â”€â”€ package.json                             (no changes)
```

### Files Summary

**New Files (6 for MVP):**
1. `/src/utils/characters.ts` - Character type and preset definitions
2. `/src/contexts/CharacterContext.tsx` - State management
3. `/src/hooks/useCharacter.ts` - Context hook
4. `/src/components/CharacterSelector/CharacterSelector.tsx` - UI component
5. `/src/components/CharacterSelector/CharacterSelector.module.scss` - Styles
6. `/src/components/CharacterSelector/index.ts` - Export barrel

**Modified Files (7 for MVP):**
1. `/src/pages/_app.tsx` - Add CharacterProvider
2. `/src/pages/index.tsx` - Add CharacterSelector (conditional)
3. `/src/pages/api/conversation.ts` - Accept and use characterId
4. `/src/lib/openai.ts` - Support character-specific prompts
5. `/src/components/ChatInput/ChatInput.tsx` - Pass characterId to API
6. `/src/components/index.ts` - Export CharacterSelector
7. `README.md` - Document character feature

**Additional Files (Stretch Goal):**
8. `/src/components/CharacterSelector/CharacterCard.tsx` - Card component
9. `/src/components/CharacterSelector/CustomCharacterModal.tsx` - Custom creation

**Total MVP**: 6 new + 7 modified = 13 files

---

## Type Definitions Overview

### Core Types

```typescript
// Character Type
type Character = {
  id: string;                    // 'friendly-tutor'
  name: string;                  // 'Friendly Tutor'
  description: string;           // 'Patient and encouraging...'
  systemPrompt: string;          // AI personality prompt
  icon?: string;                 // 'ğŸ‘¨â€ğŸ«'
  tags?: string[];              // ['learning', 'supportive']
  isCustom?: boolean;           // For stretch goal
};

// Context Type
type CharacterContextType = {
  selectedCharacter: Character;
  setSelectedCharacter: (character: Character) => void;
  availableCharacters: Character[];
  addCustomCharacter?: (character: Character) => void;     // Stretch
  removeCustomCharacter?: (characterId: string) => void;   // Stretch
};

// API Request Type (Enhanced)
type ConversationRequest = {
  userMessage: string;
  targetLanguage: string;
  conversationHistory?: Array<{
    role: 'user' | 'assistant';
    content: string;
  }>;
  characterId?: string;          // NEW
  customSystemPrompt?: string;   // NEW (Stretch goal)
};
```

---

## Character Definitions Visual

### Preset Character Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Preset Characters                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Characterâ”‚ Personality  â”‚ Use Case     â”‚ Example Response     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘¨â€ğŸ«      â”‚ Patient,     â”‚ Beginners,   â”‚ "That's great!      â”‚
â”‚ Friendly â”‚ encouraging, â”‚ learning,    â”‚  You're improving.   â”‚
â”‚ Tutor    â”‚ educational  â”‚ confidence   â”‚  Let me tell you..." â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ˜Š       â”‚ Informal,    â”‚ Casual chat, â”‚ "Oh cool! I love    â”‚
â”‚ Casual   â”‚ warm,        â”‚ fluency,     â”‚  that too. Have     â”‚
â”‚ Friend   â”‚ conversational everyday     â”‚  you ever..."        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¼       â”‚ Formal,      â”‚ Business,    â”‚ "Thank you for      â”‚
â”‚ Business â”‚ professional,â”‚ workplace,   â”‚  bringing that to   â”‚
â”‚ Pro      â”‚ courteous    â”‚ formal       â”‚  my attention..."    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŒ       â”‚ Energetic,   â”‚ Travel,      â”‚ "Oh, you must       â”‚
â”‚ Travel   â”‚ descriptive, â”‚ cultural,    â”‚  visit! The arch... â”‚
â”‚ Guide    â”‚ enthusiastic â”‚ descriptive  â”‚  is breathtaking!" â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ§™       â”‚ Thoughtful,  â”‚ Deep talks,  â”‚ "Interesting obs.   â”‚
â”‚ Wise     â”‚ reflective,  â”‚ mature       â”‚  Have you           â”‚
â”‚ Mentor   â”‚ philosophicalâ”‚ learners     â”‚  considered..."      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Character Tone Spectrum

```
Formal â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Informal
  â”‚                    â”‚                   â”‚        â”‚
  ğŸ’¼                  ğŸ‘¨â€ğŸ«                  ğŸ§™       ğŸ˜Š
  Business           Friendly             Wise     Casual
  Professional       Tutor                Mentor   Friend

                     ğŸŒ
                Travel Guide
               (Energetic/Descriptive)
```

---

**Document Version**: 1.0  
**Last Updated**: 2025-12-13  
**Status**: Ready for Development  
**Related Docs**: character-selection-plan.md, character-selection-summary.md, character-selection-quick-reference.md
